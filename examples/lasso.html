<!-- START SIGMA IMPORTS -->
<script src="../src/sigma.core.js"></script>
<script src="../src/conrad.js"></script>
<script src="../src/utils/sigma.utils.js"></script>
<script src="../src/utils/sigma.polyfills.js"></script>
<script src="../src/sigma.settings.js"></script>
<script src="../src/classes/sigma.classes.dispatcher.js"></script>
<script src="../src/classes/sigma.classes.configurable.js"></script>
<script src="../src/classes/sigma.classes.graph.js"></script>
<script src="../src/classes/sigma.classes.camera.js"></script>
<script src="../src/classes/sigma.classes.quad.js"></script>
<script src="../src/classes/sigma.classes.edgequad.js"></script>
<script src="../src/captors/sigma.captors.mouse.js"></script>
<script src="../src/captors/sigma.captors.touch.js"></script>
<script src="../src/renderers/sigma.renderers.canvas.js"></script>
<script src="../src/renderers/sigma.renderers.webgl.js"></script>
<script src="../src/renderers/sigma.renderers.svg.js"></script>
<script src="../src/renderers/sigma.renderers.def.js"></script>
<script src="../src/renderers/webgl/sigma.webgl.nodes.def.js"></script>
<script src="../src/renderers/webgl/sigma.webgl.nodes.fast.js"></script>
<script src="../src/renderers/webgl/sigma.webgl.edges.def.js"></script>
<script src="../src/renderers/webgl/sigma.webgl.edges.fast.js"></script>
<script src="../src/renderers/webgl/sigma.webgl.edges.arrow.js"></script>
<script src="../src/renderers/canvas/sigma.canvas.labels.def.js"></script>
<script src="../src/renderers/canvas/sigma.canvas.hovers.def.js"></script>
<script src="../src/renderers/canvas/sigma.canvas.nodes.def.js"></script>
<script src="../src/renderers/canvas/sigma.canvas.edges.def.js"></script>
<script src="../src/renderers/canvas/sigma.canvas.edges.curve.js"></script>
<script src="../src/renderers/canvas/sigma.canvas.edges.arrow.js"></script>
<script src="../src/renderers/canvas/sigma.canvas.edges.curvedArrow.js"></script>
<script src="../src/renderers/canvas/sigma.canvas.edgehovers.def.js"></script>
<script src="../src/renderers/canvas/sigma.canvas.edgehovers.curve.js"></script>
<script src="../src/renderers/canvas/sigma.canvas.edgehovers.arrow.js"></script>
<script src="../src/renderers/canvas/sigma.canvas.edgehovers.curvedArrow.js"></script>
<script src="../src/renderers/canvas/sigma.canvas.extremities.def.js"></script>
<script src="../src/renderers/svg/sigma.svg.utils.js"></script>
<script src="../src/renderers/svg/sigma.svg.nodes.def.js"></script>
<script src="../src/renderers/svg/sigma.svg.edges.def.js"></script>
<script src="../src/renderers/svg/sigma.svg.edges.curve.js"></script>
<script src="../src/renderers/svg/sigma.svg.labels.def.js"></script>
<script src="../src/renderers/svg/sigma.svg.hovers.def.js"></script>
<script src="../src/middlewares/sigma.middlewares.rescale.js"></script>
<script src="../src/middlewares/sigma.middlewares.copy.js"></script>
<script src="../src/misc/sigma.misc.animation.js"></script>
<script src="../src/misc/sigma.misc.bindEvents.js"></script>
<script src="../src/misc/sigma.misc.bindDOMEvents.js"></script>
<script src="../src/misc/sigma.misc.drawHovers.js"></script>
<!-- END SIGMA IMPORTS -->
<!-- START LASSO IMPORTS -->
<script src="../plugins/sigma.plugins.lasso/sigma.plugins.lasso.js"></script>
<!-- END LASSO IMPORTS -->
<div id="container">
  <style>
    #graph-container {
      background: #eee;
      height: 600px;
      max-width: 800px;
      margin: auto;
      position: relative;
      overflow: hidden;
    }
  </style>
  <div id="graph-container"></div>
</div>
<script>
(function() {
  'use strict';

  var sigmaInstance,
      camera,
      nId = 0,
      eId = 0,
      nodeRadius = 50;

  /**
   * INITIALIZATION SCRIPT:
   * **********************
   */
  sigmaInstance = new sigma({
    renderer: {
      container: document.getElementById('graph-container'),
      type: 'canvas'
    },
    settings: {
      autoRescale: true,
      mouseEnabled: true,
      touchEnabled: true,
      nodesPowRatio: 1,
      edgesPowRatio: 1,
      sideMargin: 2,
      defaultEdgeColor: '#333',
      defaultNodeColor: '#333',
      edgeColor: 'default'
    }
  });
  camera = sigmaInstance.camera;

  // Initialize graph:
  sigmaInstance.graph.read({
    nodes: [
      {
        id: (++nId) + '',
        size: nodeRadius,
        x: 0,
        y: 0,
        dX: 0,
        dY: 0,
        type: 'goo'
      },
      {
        id: (++nId) + '',
        size: nodeRadius,
        x: 10,
        y: -10,
        dX: 0,
        dY: 0,
        type: 'goo'
      },
      {
        id: (++nId) + '',
        size: nodeRadius,
        x: 20,
        y: -8,
        dX: 0,
        dY: 0,
        type: 'goo'
      },
      {
        id: (++nId) + '',
        size: nodeRadius,
        x: -5,
        y: -15,
        dX: 0,
        dY: 0,
        type: 'goo'
      },
      {
        id: (++nId) + '',
        size: nodeRadius,
        x: -25,
        y: 4,
        dX: 0,
        dY: 0,
        type: 'goo'
      },
      {
        id: (++nId) + '',
        size: nodeRadius,
        x: 18,
        y: 2,
        dX: 0,
        dY: 0,
        type: 'goo'
      },
      {
        id: (++nId) + '',
        size: nodeRadius,
        x: -4,
        y: -6,
        dX: 0,
        dY: 0,
        type: 'goo'
      }
    ],
    edges: [
      {
        id: (++eId) + '',
        source: '1',
        target: '2'
      },
      {
        id: (++eId) + '',
        source: '1',
        target: '3'
      },
      {
        id: (++eId) + '',
        source: '2',
        target: '3'
      },
      {
        id: (++eId) + '',
        source: '4',
        target: '2'
      },
      {
        id: (++eId) + '',
        source: '5',
        target: '6'
      },
      {
        id: (++eId) + '',
        source: '7',
        target: '1'
      },
      {
        id: (++eId) + '',
        source: '6',
        target: '7'
      }
    ]
  });

  sigmaInstance.refresh();

  // Init the lasso with sigmaInstance, renderer and settings
  var lasso = new sigma.plugins.lasso(sigmaInstance, sigmaInstance.renderers[0], {
    'fillStyle': 'transparent',
    'strokeStyle': 'black',
    'lineWidth': 2,
    'fillWhileDrawing': false,
    'displayFeedback': true,
    'displayFeedbackColor': 'rgb(42, 187, 155)'
  });

  // Listen for selectedNodes event
  lasso.bind('sigma:lasso:selectedNodes', function (event) {
    // Do something with the selected nodes
    var nodes = event.data;

    console.log('nodes', nodes);

    // For instance, reset all node size as their initial size
    sigmaInstance.graph.nodes().forEach(function (node) {
      node.size = nodeRadius;
    });

    // Then increase the size of selected nodes...
    nodes.forEach(function (node) {
      node.size *= 3;
    });

    sigmaInstance.refresh();
  });

  // Toggle lasso activation on Alt + l
  document.addEventListener('keyup', function (event) {
    if (event.keyCode === 76 && event.altKey) {
      lasso.toggleActivation();
    }
  });

})();
</script>
